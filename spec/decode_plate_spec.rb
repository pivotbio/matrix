require 'spec_helper'

describe 'decode_plate' do
  it 'can decode a scanned 96 well plate containing 2D QR-coded tubes' do
    expect(decode_plate('spec/data/scan.tiff')).to eq(["0135524809", "0135525000", "0135524999", "0135524976", "0135524975", "0135524952", "0135524951", "0135524928", "0135524806", "0135525001", "0135524998", "0135524977", "0135524974", "0135524953", "0135524950", "0135524929", "0135525021", "0135525002", "0135524997", "0135524785", "0135524973", "0135524954", "0135524949", "0135524930", "0135525020", "0135525003", "0135524782", "0135524979", "0135524972", "0135524955", "0135524948", "0135524931", "0135525019", "0135525004", "0135524995", "0135524980", "0135524971", "0135524956", "0135524947", "0135524932", "0135525018", "0135525005", "0135524994", "0135524981", "0135524970", "0135524957", "0135524946", "0135524933", "0135525017", "0135525006", "0135524993", "0135524982", "0135524969", "0135524958", "0135524945", "0135524934", "0135525016", "0135525007", "0135524992", "0135524983", "0135524968", "0135524959", "0135524944", "0135524935", "0135525015", "0135525008", "0135524991", "0135524786", "0135524967", "0135524960", "0135524943", "0135524936", "0135525014", "0135525009", "0135524990", "0135524985", "0135524966", "0135524961", "0135524942", "0135524937", "0135525013", "0135525010", "0135524989", "0135524986", "0135524965", "0135524962", "0135524941", "0135524938", "0135524761", "0135525011", "0135524988", "0135524987", "0135524964", "0135524737", "0135524758", "0135524829"])
  end

  it 'should not raise error when decoding a good scan file', focus: true do
    expect{ decode_plate('spec/data/scan.tiff') }.to_not raise_error
  end

  it 'should raise error when decoding nonsense file', focus: true do
    expect{ decode_plate('spec/data/nonsense.jpeg') }.to raise_error(DecodeError)
  end
end
